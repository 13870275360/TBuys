{"version":3,"sources":["../../routes/home.js"],"names":["module","exports","app","get","req","res","session","user","Commodity","global","dbHelper","getModel","find","error","docs","render","Commoditys","redirect","post","create","name","body","price","imgSrc","doc","sendStatus"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiB,UAAUC,GAAV,EAAe;AAC5BA,QAAIC,GAAJ,CAAQ,OAAR,EAAiB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACjC,YAAID,IAAIE,OAAJ,CAAYC,IAAhB,EAAsB;AAClB,gBAAIC,YAAYC,OAAOC,QAAP,CAAgBC,QAAhB,CAAyB,WAAzB,CAAhB;AACAH,sBAAUI,IAAV,CAAe,EAAf,EAAmB,UAAUC,KAAV,EAAiBC,IAAjB,EAAuB;AACtC;AACAT,oBAAIU,MAAJ,CAAW,MAAX,EAAmB,EAACC,YAAYF,IAAb,EAAnB;AACH,aAHD;AAIH,SAND,MAMO;AACHV,gBAAIE,OAAJ,CAAYO,KAAZ,GAAoB,MAApB;AACAR,gBAAIY,QAAJ,CAAa,QAAb;AACH;AACJ,KAXD;AAYAf,QAAIC,GAAJ,CAAQ,eAAR,EAAyB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACzCA,YAAIU,MAAJ,CAAW,cAAX;AACH,KAFD;AAGAb,QAAIgB,IAAJ,CAAS,gBAAT,EAA2B,UAAUd,GAAV,EAAeC,GAAf,EAAoB;AAC3C,YAAIG,YAAYC,OAAOC,QAAP,CAAgBC,QAAhB,CAAyB,WAAzB,CAAhB;AACAH,kBAAUW,MAAV,CAAiB;AACbC,kBAAMhB,IAAIiB,IAAJ,CAASD,IADF;AAEbE,mBAAOlB,IAAIiB,IAAJ,CAASC,KAFH;AAGbC,oBAAQnB,IAAIiB,IAAJ,CAASE;AAHJ,SAAjB,EAIG,UAAUV,KAAV,EAAiBW,GAAjB,EAAsB;AACrB,gBAAIA,GAAJ,EAAS;AACLnB,oBAAIoB,UAAJ,CAAe,GAAf;AACH,aAFD,MAEO;AACHpB,oBAAIoB,UAAJ,CAAe,GAAf;AACH;AACJ,SAVD;AAWH,KAbD;AAcH,CA9BD","file":"home.js","sourcesContent":["module.exports = function (app) {\r\n    app.get('/home', function (req, res) {\r\n        if (req.session.user) {\r\n            var Commodity = global.dbHelper.getModel('commodity');\r\n            Commodity.find({}, function (error, docs) {\r\n                //将Commoditys变量传入home模板\r\n                res.render('home', {Commoditys: docs});\r\n            })\r\n        } else {\r\n            req.session.error = \"请先登录\";\r\n            res.redirect('/login');\r\n        }\r\n    });\r\n    app.get('/addcommodity', function (req, res) {\r\n        res.render('addcommodity');\r\n    });\r\n    app.post('./addcommodity', function (req, res) {\r\n        var Commodity = global.dbHelper.getModel('commodity');\r\n        Commodity.create({\r\n            name: req.body.name,\r\n            price: req.body.price,\r\n            imgSrc: req.body.imgSrc\r\n        }, function (error, doc) {\r\n            if (doc) {\r\n                res.sendStatus(200);\r\n            } else {\r\n                res.sendStatus(404);\r\n            }\r\n        })\r\n    })\r\n};"]}