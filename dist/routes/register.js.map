{"version":3,"sources":["../../routes/register.js"],"names":["module","exports","app","get","req","res","render","post","User","global","dbHelper","getModel","uname","body","findOne","name","error","doc","session","sendStatus","create","password","upwd","send"],"mappings":";;AAAA;AACAA,OAAOC,OAAP,GAAiB,UAAUC,GAAV,EAAe;AAC5BA,QAAIC,GAAJ,CAAQ,WAAR,EAAqB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACrCA,YAAIC,MAAJ,CAAW,UAAX;AACH,KAFD;AAGAJ,QAAIK,IAAJ,CAAS,WAAT,EAAsB,UAAUH,GAAV,EAAeC,GAAf,EAAoB;AACtC,YAAIG,OAAOC,OAAOC,QAAP,CAAgBC,QAAhB,CAAyB,MAAzB,CAAX;AAAA,YACIC,QAAQR,IAAIS,IAAJ,CAASD,KADrB;AAEAJ,aAAKM,OAAL,CAAa,EAACC,MAAMH,KAAP,EAAb,EAA4B,UAAUI,KAAV,EAAiBC,GAAjB,EAAsB;AAC9C,gBAAIA,GAAJ,EAAS;AACLb,oBAAIc,OAAJ,CAAYF,KAAZ,GAAoB,SAApB;AACAX,oBAAIc,UAAJ,CAAe,GAAf;AACH,aAHD,MAGO;AACHX,qBAAKY,MAAL,CAAY;AACRL,0BAAMH,KADE;AAERS,8BAAUjB,IAAIS,IAAJ,CAASS;AAFX,iBAAZ,EAGG,UAAUN,KAAV,EAAiBC,GAAjB,EAAsB;AACrB,wBAAID,KAAJ,EAAW;AACPX,4BAAIkB,IAAJ,CAAS,GAAT;AACH,qBAFD,MAEO;AACHnB,4BAAIc,OAAJ,CAAYF,KAAZ,GAAoB,UAApB;AACAX,4BAAIkB,IAAJ,CAAS,GAAT;AACH;AACJ,iBAVD;AAWH;AACJ,SAjBD;AAkBH,KArBD;AAsBH,CA1BD","file":"register.js","sourcesContent":["//app：express对象\r\nmodule.exports = function (app) {\r\n    app.get('/register', function (req, res) {\r\n        res.render('register');\r\n    });\r\n    app.post('/register', function (req, res) {\r\n        var User = global.dbHelper.getModel('user'),\r\n            uname = req.body.uname;\r\n        User.findOne({name: uname}, function (error, doc) {\r\n            if (doc) {\r\n                req.session.error = '用户名已存在！';\r\n                res.sendStatus(500);\r\n            } else {\r\n                User.create({\r\n                    name: uname,\r\n                    password: req.body.upwd\r\n                }, function (error, doc) {\r\n                    if (error) {\r\n                        res.send(500);\r\n                    } else {\r\n                        req.session.error = '用户名创建成功！';\r\n                        res.send(200);\r\n                    }\r\n                })\r\n            }\r\n        })\r\n    })\r\n};"]}