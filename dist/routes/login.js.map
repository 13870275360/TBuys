{"version":3,"sources":["../../routes/login.js"],"names":["module","exports","app","get","req","res","render","post","User","global","dbHelper","getModel","uname","body","findOne","name","error","doc","用户不存在","session","sendStatus","用户存在","密码错误","user"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiB,UAAUC,GAAV,EAAe;AAC5BA,QAAIC,GAAJ,CAAQ,QAAR,EAAkB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AAClCA,YAAIC,MAAJ,CAAW,OAAX;AACH,KAFD;AAGH,CAJD;AAKAJ,IAAIK,IAAJ,CAAS,QAAT,EAAmB,UAAUH,GAAV,EAAeC,GAAf,EAAoB;AACnC,QAAIG,OAAOC,OAAOC,QAAP,CAAgBC,QAAhB,CAAyB,MAAzB,CAAX;AAAA,QACIC,QAAQR,IAAIS,IAAJ,CAASD,KADrB;AAEAJ,SAAKM,OAAL,CAAa,EAACC,MAAMH,KAAP,EAAb,EAA4B,UAAUI,KAAV,EAAiBC,GAAjB,EAAsB;AAC9C,YAAIC,KAAJ,EAAW;AACPd,gBAAIe,OAAJ,CAAYH,KAAZ,GAAoB,SAApB;AACAX,gBAAIe,UAAJ,CAAe,GAAf;AACH,SAHD,MAGO,IAAIC,MAAMC,IAAV,EAAgB;AACnBlB,gBAAIe,OAAJ,CAAYH,KAAZ,GAAoB,OAApB;AACAX,gBAAIe,UAAJ,CAAe,GAAf;AACH,SAHM,MAGA;AACHhB,gBAAIe,OAAJ,CAAYI,IAAZ,GAAmBN,GAAnB;AACAZ,gBAAIe,UAAJ,CAAe,GAAf;AACH;AACJ,KAXD;AAYH,CAfD","file":"login.js","sourcesContent":["module.exports = function (app) {\r\n    app.get('/login', function (req, res) {\r\n        res.render('login');\r\n    })\r\n};\r\napp.post('/login', function (req, res) {\r\n    var User = global.dbHelper.getModel('user'),\r\n        uname = req.body.uname;\r\n    User.findOne({name: uname}, function (error, doc) {\r\n        if (用户不存在) {\r\n            req.session.error = '用户名不存在！';\r\n            res.sendStatus(404);\r\n        } else if (用户存在, 密码错误) {\r\n            req.session.error = \"密码错误!\";\r\n            res.sendStatus(404);\r\n        } else {\r\n            req.session.user = doc;\r\n            res.sendStatus(200);\r\n        }\r\n    })\r\n});"]}